#/bin/sh

#compile camera.cpp separately from remaing C files 
gcc -g -fPIC -c *.c 

#create both shared and static library for utilities, so -ldynamic is sufficient to link executable
gcc -g -fPIC -shared -o libutilities.so utilities.o
ar rcs libutilities.a utilities.o

#core shared libraries
gcc -g -fPIC -shared -o libgraph.so graph.o -L. -lutilities 
gcc -g -fPIC -shared -o libjohn.so john.o -L. -lutilities -ldynamic -lxserver
gcc -g -fPIC -shared -o libexport.so export.o -lpng -L. -lutilities
gcc -g -fPIC -shared -o libimport.so import.o -lpng -L. -lutilities
gcc -g -fPIC -shared -o libdynamic.so dynamic.o -ldl -lpthread -L. libutilities.a 
gcc -g -fPIC -shared -o libstd.so std.o -L. -lutilities -ldynamic
gcc -g -fPIC -shared -o libxserver.so xserver.o -L/usr/X11/lib -lX11 -L. -lutilities -ldynamic 
gcc -g -fPIC -shared -o libxclient.so xclient.o keymap.o drawing.o callback.o -L. -lutilities -ldynamic -lexport -limport -lxserver
gcc -g -fPIC -shared -o libinterpret.so interpret.o -L. -lutilities -ldynamic -lgraph 

#executable
gcc -g -o iScope.x control.c -L. -ldynamic

#add current directory to path to locate libraries
LD_LIBRARY_PATH=$LD_LIBRARY_PATH\:.
export LD_LIBRARY_PATH
